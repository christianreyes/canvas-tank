Function.prototype.inheritsFrom=function(a){a.constructor==Function?(this.prototype=new a,this.prototype.constructor=this,this.prototype.parent=a.prototype):(this.prototype=a,this.prototype.constructor=this,this.prototype.parent=a);return this};function mergeObjects(a,c){var b={},d;for(d in a)b[d]=a[d];for(d in c)b[d]=c[d];return b}function mergeWithDefault(a,c){var b=defaultIfUndefined(a,c);return b=mergeObjects(c,a)}function defaultIfUndefined(a,c){return typeof a=="undefined"?c:a}
function Doodle(a){this.context=a;this.children=[]}Doodle.prototype.draw=function(){for(var a=0;a<this.children.length;a++)this.context.save(),this.children[a].draw(this.context),this.context.restore()};function Drawable(a){a=mergeWithDefault(a,{left:0,top:0,visible:true,theta:0});this.left=a.left;this.top=a.top;this.visible=a.visible;this.theta=a.theta}Drawable.prototype.draw=function(){console.log("ERROR: Calling unimplemented draw method on drawable object.")};
function Primitive(a){a=mergeWithDefault(a,{lineWidth:1,color:"black"});Drawable.call(this,a);this.lineWidth=a.lineWidth;this.color=a.color}Primitive.inheritsFrom(Drawable);function Text(a){a=mergeWithDefault(a,{content:"",fill:"black",font:"12pt Helvetica",height:12});Drawable.call(this,a);this.content=a.content;this.fill=a.fill;this.font=a.font;this.height=a.height}Text.inheritsFrom(Drawable);
Text.prototype.draw=function(a){a.fillStyle=this.fill;a.font=this.font;a.fillText(this.content,this.left,this.height)};function DoodleImage(a){a=mergeWithDefault(a,{width:-1,height:-1,src:""});Drawable.call(this,a);this.width=a.width;this.height=a.height;this.src=a.src}DoodleImage.inheritsFrom(Drawable);DoodleImage.prototype.draw=function(a){var c=new Image,b=this.left,d=this.top,e=this.width,f=this.height;c.src=this.src;e!=-1&&f!=-1?a.drawImage(c,b,d,e,f):a.drawImage(c,b,d)};
function Line(a){a=mergeWithDefault(a,{startX:0,startY:0,endX:0,endY:0,lineWidth:1});Primitive.call(this,a);this.startX=a.startX;this.startY=a.startY;this.endX=a.endX;this.endY=a.endY;this.lineWidth=a.lineWidth}Line.inheritsFrom(Primitive);Line.prototype.draw=function(a){a.beginPath();if(typeof this.lineWidth!="undefined")a.lineWidth=this.lineWidth;if(typeof this.color!="undefined")a.strokeStyle=this.color;a.moveTo(this.startX,this.startY);a.lineTo(this.endX,this.endY);a.closePath();a.stroke()};
function Path(a){a=mergeWithDefault(a,{type:"straight",points:[],fill:""});Primitive.call(this,a);this.type=a.type;this.points=a.points;this.fill=a.fill}Path.inheritsFrom(Primitive);
Path.prototype.draw=function(a){if(this.points.length>0){a.beginPath();a.moveTo(this.points[0].x,this.points[0].y);if(typeof this.lineWidth!="undefined")a.lineWidth=this.lineWidth;if(typeof this.color!="undefined")a.strokeStyle=this.color;if(this.fill!="")a.fillStyle=this.fill;switch(this.type){case "straight":for(var c=1;c<this.points.length;c++){var b=this.points[c];a.lineTo(b.x,b.y)}break;case "quadratic":for(c=1;c<this.points.length;c++)b=this.points[c],a.quadraticCurveTo(b.cp1x,b.cp1y,b.x,b.y);
break;case "bezier":for(c=1;c<this.points.length;c++)b=this.points[c],a.bezierCurveTo(b.cp1x,b.cp1y,b.cp2x,b.cp2y,b.x,b.y)}this.fill!=""?a.fill():a.stroke()}};
function Arc(a){a=mergeWithDefault(a,{centerX:0,centerY:0,radius:0,startingTheta:0,endingTheta:0,counterclockwise:false,fill:""});Primitive.call(this,a);this.centerX=a.centerX;this.centerY=a.centerY;this.radius=a.radius;this.startingTheta=a.startingTheta;this.endingTheta=a.endingTheta;this.counterclockwise=a.counterclockwise;this.left=a.centerX-a.radius;this.top=a.centerY-a.radius;this.fill=a.fill}Arc.inheritsFrom(Primitive);
Arc.prototype.draw=function(a){a.beginPath();if(typeof this.lineWidth!="undefined")a.lineWidth=this.lineWidth;if(typeof this.color!="undefined")a.strokeStyle=this.color;a.arc(this.centerX,this.centerY,this.radius,this.startingTheta,this.endingTheta,this.counterclockwise);if(this.fill!="")a.fillStyle=this.fill,a.fill();a.stroke()};
function Container(a){a=mergeWithDefault(a,{width:100,height:100,fill:"",borderColor:"black",borderWidth:0,gradient:"",xVelocity:0,yVelocity:0});Drawable.call(this,a);this.children=[];this.width=a.width;this.height=a.height;this.fill=a.fill;this.borderColor=a.borderColor;this.borderWidth=a.borderWidth;this.gradient=a.gradient;this.xVelocity=a.xVelocity;this.yVelocity=a.yVelocity}Container.inheritsFrom(Drawable);
Container.prototype.draw=function(a){a.save();if(this.borderWidth!=0)a.lineWidth=this.borderWidth;a.translate(this.left,this.top);a.rotate(this.theta);a.beginPath();a.moveTo(0,0);a.lineTo(this.width,0);a.lineTo(this.width,this.height);a.lineTo(0,this.height);a.lineTo(0,0);a.closePath();if(this.fill!="")a.fillStyle=this.fill,a.fill();if(this.gradient!=""){for(var c=a.createLinearGradient(0,0,this.width,this.height),b=0;b<this.gradient.length;b++){var d=this.gradient[b];c.addColorStop(d.position,d.color)}a.fillStyle=
c;a.fill()}this.borderWidth!=0&&a.stroke();a.clip();for(b=0;b<this.children.length;b++)c=this.children[b],a.save(),c.draw(a),a.restore();a.restore()};function PolygonContainer(a){a=mergeWithDefault(a,{radius:100,sides:3,centerX:100,centerY:100,polygonTheta:0});Container.call(this,a);this.radius=a.radius;this.sides=a.sides;this.centerX=a.centerX;this.centerY=a.centerY;this.polygonTheta=a.polygonTheta;this.left=a.centerX-a.radius;this.top=a.centerY-a.radius}PolygonContainer.inheritsFrom(Container);
PolygonContainer.prototype.draw=function(a){a.save();if(this.borderWidth!=0)a.lineWidth=this.borderWidth;if(typeof this.borderColor!="undefined")a.strokeStyle=this.borderColor;if(typeof this.fill!="undefined")a.fillStyle=this.fill;a.save();a.translate(this.centerX,this.centerY);a.rotate(-this.polygonTheta);var c=360/this.sides*(Math.PI/180);a.beginPath();a.moveTo(this.radius,0);for(var b=1;b<=this.sides;b++){var d=c*b,e=this.radius*Math.cos(d),d=this.radius*Math.sin(d);a.lineTo(e,d)}a.closePath();
a.fill();a.stroke();a.clip();a.restore();a.save();a.translate(this.left,this.top);for(b=0;b<this.children.length;b++)c=this.children[b],a.save(),c.draw(a),a.restore();a.restore();a.restore()};
var _canvas_width=800,_canvas_height=500,x_pos=_canvas_width/2,y_pos=_canvas_height/2,_doodle=void 0,_ground=void 0,_truck_container=void 0,_launcher=void 0,_arrow=void 0,_arrow_container=void 0,_move_arr=[],_balloons=[],_time_step=10,_time_s_to_ms=_time_step/1E3,_gravity=5,_gravity_increment=_gravity*_time_s_to_ms,_x_per_sec=3,_y_per_sec=-4,_power=6.75,_fire=false,_dirty=true,_score=void 0,_balloon_min_x=0.25,_balloon_max_x=1.75;
window.onload=function(){var a=document.getElementById("canvas"),c=a.getContext("2d");a.style.width=_canvas_width+"px";a.style.height=_canvas_height+"px";a.width=_canvas_width;a.height=_canvas_height;_doodle=new Doodle(c);_ground=new Container({width:_canvas_width,height:50,left:0,fill:"brown",top:_canvas_height-50,borderWidth:2});_truck_container=new Container({width:80,height:80,left:10,top:_canvas_height-50-80,borderWidth:0});_launcher=new Container({top:55,left:10,width:40,height:10,theta:-Math.PI/
3,fill:"#156100",borderWidth:1});var a=new Arc({centerX:11,centerY:72,lineWidth:1,radius:7,fill:"#333",startingTheta:0,endingTheta:Math.PI*2}),c=new Arc({centerX:28,centerY:72,lineWidth:1,radius:7,fill:"#333",startingTheta:0,endingTheta:Math.PI*2}),b=new Arc({centerX:68,centerY:72,lineWidth:1,fill:"#333",radius:7,startingTheta:0,endingTheta:Math.PI*2}),d=new Container({top:60,left:0,height:8,width:80,fill:"#156100",borderWidth:1});_truck_container.children=[a,c,b,d,_launcher];_arrow_container=new Container({width:18,
height:6,left:_truck_container.left+_launcher.left,top:_truck_container.top+_launcher.top,theta:_launcher.theta,borderWidth:0});a=new Line({startX:2,startY:3,endX:16,endY:3,lineWidth:1});c=new Path({color:"black",fill:"black",lineWidth:1,type:"straight",points:[{x:18,y:3},{x:15,y:0},{x:15,y:6}]});b=new Path({color:"black",lineWidth:1,type:"straight",points:[{x:0,y:1},{x:4,y:3},{x:0,y:5}]});_arrow_container.children=[b,a,c];a=new Text({left:20,height:40,content:"Score: "});_score=new Text({left:80,
height:40,content:"0"});_doodle.children=[a,_score,_arrow_container,_ground,_truck_container];_doodle.draw();window.addEventListener("keydown",doKeyDown,true);setInterval(createBalloons,2E3);setInterval(updateAndDraw,_time_step)};function canvasMouseMove(a,c){var b=a.getBoundingClientRect();_x_pos=(c.clientX-b.left)*(a.width/b.width);_y_pos=(c.clientY-b.top)*(a.width/b.width)}
function createBalloons(){var a=new Container({top:Math.random()*(_canvas_height-70),left:_canvas_width+10,height:16,width:16,borderWidth:0,xVelocity:_balloon_min_x+Math.random()*(_balloon_max_x-_balloon_min_x)}),c=new Arc({centerX:8,centerY:8,lineWidth:1,fill:"red",radius:6,startingTheta:0,endingTheta:Math.PI*2});a.children=[c];_doodle.children.push(a);_balloons.push(a)}
function moveBalloons(){for(var a=0;a<_balloons.length;a++){var c=_balloons[a];c.left-=c.xVelocity;if(Math.abs(c.left-_arrow_container.left)<=12&&Math.abs(c.top-_arrow_container.top)<=12){_balloons.splice(a,1);for(var b=0;b<_doodle.children.length;b++)if(_doodle.children[b]==c)_doodle.children.splice(b,1),_score.content=parseInt(_score.content,10)+1}else if(c.left+15<0){_balloons.splice(a,1);for(b=0;b<_doodle.children.length;b++)_doodle.children[b]==c&&_doodle.children.splice(b,1)}}}
function updateAndDraw(){_dirty&&_doodle.context.clearRect(0,0,_canvas_width,_canvas_height-50);moveBalloons();_fire&&fallingArrow();_doodle.draw()}function clearDirty(a){for(var c=0;c<a.length;c++){var b=a[c];_doodle.context.save();_doodle.context.transform(b.left,b.top);_doodle.context.rotate(-b.theta);_doodle.context.clearRect(0,0,b.width,b.height);_doodle.context.restore()}}
function fallingArrow(){if(_arrow_container.top<_canvas_height&&_arrow_container.left<_canvas_width){_dirty=true;_y_per_sec+=_gravity_increment;var a=_arrow_container.left,c=_arrow_container.top,a=Math.atan((c+_y_per_sec-c)/(a+_x_per_sec-a));_arrow_container.left+=_x_per_sec;_arrow_container.top+=_y_per_sec;_arrow_container.theta=a}else _fire=false,_dirty=true,_arrow_container.left=_truck_container.left+_launcher.left,_arrow_container.top=_truck_container.top+_launcher.top,_arrow_container.theta=
_launcher.theta,_x_per_sec=_power*Math.cos(-1*_arrow_container.theta),_y_per_sec=-1*_power*Math.sin(-1*_arrow_container.theta)}
function doKeyDown(a){switch(a.keyCode){case 38:if(_launcher.theta+Math.PI/2>0.2&&(_dirty=true,_launcher.theta-=0.1,!_fire))_arrow_container.theta=_launcher.theta,_x_per_sec=_power*Math.cos(-1*_arrow_container.theta),_y_per_sec=-1*_power*Math.sin(-1*_arrow_container.theta);break;case 40:if(_launcher.theta<-0.1&&(_dirty=true,_launcher.theta+=0.1,!_fire))_arrow_container.theta=_launcher.theta,_x_per_sec=_power*Math.cos(-1*_arrow_container.theta),_y_per_sec=-1*_power*Math.sin(-1*_arrow_container.theta);
break;case 37:if(_truck_container.left>5&&(_dirty=true,_truck_container.left-=3,!_fire))_arrow_container.left=_truck_container.left+_launcher.left;break;case 39:if(_canvas_width-_truck_container.left+_truck_container.width>5&&(_dirty=true,_truck_container.left+=3,!_fire))_arrow_container.left=_truck_container.left+_launcher.left;break;case 32:_fire||(_dirty=_fire=true)}};